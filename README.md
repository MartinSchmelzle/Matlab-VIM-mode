Credits to Jos van der Geest for creating the getkey function, which this work relies upon.
